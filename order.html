<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ุงุญุฌุฒ ุงูุขู - ุบุณูู ุงูุณุฌุงุฏ</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

</head>

<body>

<header>
 <div class="logo">
    <a href="index.html"><img  src="station2-01.svg" alt=" ุงููุญุทุฉ ุงูุงูุชููุงุชูููุฉ" /></a>
  </div>
  <div class="menu-toggle" id="menuToggle">โฐ</div>
  <nav>
    <ul id="navList">
      <li><a href="index.html">ุงูุฑุฆูุณูุฉ</a></li>
      <li><a href="service.html">ุงูุฎุฏูุงุช</a></li>
      <li><a href="order.html">ุงุญุฌุฒ ุงูุขู</a></li>
      <li><a href="folwordr.html">ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจ</a></li>
      <li><a href="#">ุงูุชููููุงุช</a></li>
      <li><a href="https://wa.me/9647832460670?text=ูุฑุญุจุงุ%20ุฃุฑุบุจ%20ุจูุนุฑูุฉ%20ุชูุงุตูู%20ุงูุฎุฏูุงุช" target="_blank" class="action-button whatsapp">ุชูุงุตู ูุนูุง</a></li>
    </ul>
  </nav>
</header>


 <main class="booking-container">
  <h1>ุงุญุฌุฒ ุงูุขู</h1>

  <!-- ุฑูู ุงูุญุฌุฒ ูุธูุฑ ููุง -->
<!-- <div id="orderNumberDisplay" style="font-size: 1.1rem; font-weight: bold; color: green; margin-bottom: 15px;">
  ุฑูู ุงูุญุฌุฒ ุงูุฎุงุต ุจู: ุฌุงุฑู ุงูุชุญููู...
</div> -->

<form id="bookingForm" class="booking-form">
  <!-- <label for="orderNumber">ุฑูู ุงูุญุฌุฒ:</label>
<input type="text" id="orderNumber" name="orderNumber" readonly style="background-color:#eee; font-weight:bold;"> -->
  <label for="name">ุงูุงุณู ุงููุงูู:</label>
  <input type="text" id="name" name="name" required>

  <label for="phone">ุฑูู ุงููุงุชู:</label>
  <input type="tel" id="phone" name="phone" required>

<!-- ุฒุฑ ุชุญุฏูุฏ ุงููููุน -->
<!-- <button type="button" onclick="getLocation()" style="margin-top: 5px;" id="locateBtn">๐ ุชุญุฏูุฏ ูููุนู</button> -->

<!-- ุฅุญุฏุงุซูุงุช -->
 <label for="" style="color: #d80a0a;">ูู ูุถูู ููุฑ ุงูุฎุฑูุทุฉ ุนูู ูููุน ููุฒูู ุซู ูู ุจุงูููุฑ ุนููู </label>
<div id="coords" style="margin: 0 0; font-size: 0.9rem; color: green;"></div>

<!-- ุฎุฑูุทุฉ -->
<div id="map" style="height: 300px; margin-bottom: 10px;"></div>
<label for="address">ุงูุนููุงู ุงููุงูู: (ุจุนุฏ ุชุญุฏูุฏ ูููุนู ููููู ุงุถุงูุฉ ูุตู ูุนููุงูู ูุซู ุฏูุงูุฉ ูุฑุนูุฉ ุงู ููู ุงูุจุงุจ...ุงูุฎ)</label>
<textarea class="txt-full-width" id="address" name="address" rows="2" required></textarea>


  <label for="carpetMainType">ููุน ุงูุณุฌุงุฏ:</label>
  <select id="carpetMainType" name="carpetMainType" required>
    <option value="">ุงุฎุชุฑ ููุน ุงูุณุฌุงุฏ</option>
    <option value="ุนุงุฏู">ุนุงุฏู</option>
    <option value="ุซุฑู ุฏู">ุซุฑู ุฏู</option>
    <option value="ูุงุฑุจุช">ูุงุฑุจุช</option>
  </select>

  <select id="carpetWeightType" name="carpetWeightType" required>
    <option value="">ุงุฎุชุฑ ุงูููุน</option>
    <option value="ุฎููู">ุฎููู</option>
    <option value="ูุณุท">ูุณุท</option>
    <option value="ุซููู">ุซููู</option>
  </select>

  <label for="size">ุงููุณุงุญุฉ ุจุงููุชุฑ ุงููุฑุจุน:</label>
  <small style="display: block; color: #666; font-size: 0.85rem; margin-bottom: 5px;">
    ูุฑุฌู ูุชุงุจุฉ ูุฌููุน ุงูุฃูุชุงุฑ (ูู ูุทุนุฉ ุชุถุฑุจ ุงูุทูู ร ุงูุนุฑุถ) ูุชูุชุจ ูุฌููุน ุงูุฃูุชุงุฑ.<br>
    ูุญู ูููู ุจููุงุณ ุงูุณุฌุงุฏ ุจุนุฏ ุนูููุฉ ุงูุบุณูู ููุฏ ูุตุจุญ ุงููุจูุบ ุฃูู ุฃู ุฃูุซุฑ ุญุณุจ ุงูููุงุณ ุงููุนูู.
  </small>
  <input type="number" id="size" name="size" placeholder="ูุซุงู: 12" required>

  <label for="estimatedPrice">ุงูุณุนุฑ ุงูุชูุฑูุจู (ุฏ.ุน):</label>
  <input type="text" id="estimatedPrice" name="estimatedPrice" readonly placeholder="ุณูุธูุฑ ุงูุณุนุฑ ููุง">

  <label for="date">ุชุงุฑูุฎ ุงูุงุณุชูุงู:</label>
  <input type="date" id="date" name="date" required>

  <label for="time">ุงูููุช ุงูููุถู:</label>
  <input type="time" id="time" name="time" required>

  <button type="button" class="submit-btn" onclick="sendBookingToGoogleSheet()">ุฅุฑุณุงู ุงูุญุฌุฒ</button>
</form>

<!-- ุณูุฑุจุช ุฌูุจ ุฑูู ุงูุญุฌุฒ + ุฅุฑุณุงู ุงูุจูุงูุงุช -->
<script>
let currentOrderNumber = ""; // ุฑูู ุงูุญุฌุฒ ุงูุญุงูู

// ุชุญููู ุฑูู ุงูุญุฌุฒ ูู Google Apps Script
function loadOrderNumber() {
  fetch("https://script.google.com/macros/s/AKfycbzIppstvyhiHMw6_C0APM7SS6BLQ4_DbEdc2Zj6PehXsYkZ6japKXPLJRtlxXdbBvN5dQ/exec")
    .then(res => res.json())
    .then(data => {
      currentOrderNumber = data.nextOrderNumber || "ORD-1001";
      document.getElementById("orderNumber").value = currentOrderNumber;
    })
    .catch(err => {
      console.error("ูุดู ูู ุฌูุจ ุฑูู ุงูุญุฌุฒ:", err);
      document.getElementById("orderNumber").value = "ุฎุทุฃ";
    });
}

window.onload = loadOrderNumber;

function sendBookingToGoogleSheet() {
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const address = document.getElementById("address").value.trim();
  const carpetMainType = document.getElementById("carpetMainType").value;
  const carpetWeightType = document.getElementById("carpetWeightType").value;
  const size = document.getElementById("size").value.trim();
  const estimatedPrice = document.getElementById("estimatedPrice").value;
  const date = document.getElementById("date").value;
  const time = document.getElementById("time").value;

  if (!name || !phone || !address || !carpetMainType || !carpetWeightType || !size || !date || !time) {
    alert("ูุฑุฌู ููุก ุฌููุน ุงูุญููู ูุจู ุงูุฅุฑุณุงู.");
    return;
  }

  const data = {
    name,
    phone,
    address,
    carpetMainType,
    carpetWeightType,
    size,
    estimatedPrice,
    date,
    time
  };

  fetch("https://script.google.com/macros/s/AKfycbzIppstvyhiHMw6_C0APM7SS6BLQ4_DbEdc2Zj6PehXsYkZ6japKXPLJRtlxXdbBvN5dQ/exec", {
    method: "POST",
    mode: "no-cors",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(data)
  })
  .then(() => {
    alert(`โ ุชู ุฅุฑุณุงู ุงูุญุฌุฒ ุจูุฌุงุญ!\nุณูุชู ุงูุชูุงุตู ูุนู ุนุจุฑ ูุงุชุณุงุจ.`);
    openWhatsAppChat({ ...data, orderNumber: currentOrderNumber });
    document.getElementById("bookingForm").reset(); // ุชูุฑูุบ ุงูุญููู
    loadOrderNumber(); // ุชุญุฏูุซ ุฑูู ุงูุญุฌุฒ ุงูุชุงูู
  })
  .catch((error) => {
    alert("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุงูุญุฌุฒ. ุญุงูู ูุฑุฉ ุฃุฎุฑู.");
    console.error(error);
  });
}

function openWhatsAppChat(data) {
  const message =
    `๐งผ ุญุฌุฒ ุฌุฏูุฏ ูุฎุฏูุฉ ุบุณูู ุงูุณุฌุงุฏ:\n\n` +
    // `๐ข ุฑูู ุงูุญุฌุฒ: ${data.orderNumber}\n` +
    `๐ค ุงูุงุณู: ${data.name}\n` +
    `๐ ุงููุงุชู: ${data.phone}\n` +
    `๐ ุงูุนููุงู: ${data.address}\n` +
    `๐งบ ููุน ุงูุณุฌุงุฏ: ${data.carpetMainType} - ${data.carpetWeightType}\n` +
    `๐ ุงููุณุงุญุฉ: ${data.size} ูุชุฑ ูุฑุจุน\n` +
    `๐ฐ ุงูุณุนุฑ ุงูุชูุฑูุจู: ${data.estimatedPrice}\n` +
    `๐ ุงูุชุงุฑูุฎ: ${data.date}\n` +
    `โฐ ุงูููุช: ${data.time}`;

  const encodedMsg = encodeURIComponent(message);
  const whatsappLink = `https://wa.me/9647832460670?text=${encodedMsg}`;
  window.open(whatsappLink, "_blank");
}
</script>









  <!-- ุณูุฑุจุช ุงููููุน ุนูู ุงูุฎุฑูุทุฉ -->
  <script>
  // ุฅุญุฏุงุซูุงุช ุงุจุชุฏุงุฆูุฉ (ูุฌู ูุซูุงู)
  const initialLat = 32.0003;
  const initialLng = 44.3592;

  const map = L.map('map').setView([initialLat, initialLng], 14);

  // ุฎุฑูุทุฉ ููุชูุญุฉ ุงููุตุฏุฑ ูุฌุงููุฉ
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'ยฉ OpenStreetMap contributors'
  }).addTo(map);

  // ูุงุฑูุฑ ูุชุญุฏูุฏ ุงูููุทุฉ
  let marker = L.marker([initialLat, initialLng], { draggable: true }).addTo(map);

  // ุฃูู ูุง ูุชุญุฑู ุงููุงุฑูุฑ ุฃู ุงููุณุชุฎุฏู ูุถุบุท ุนูู ุงูุฎุฑูุทุฉ
  function updateAddress(lat, lng) {
    const locationLink = `https://www.google.com/maps?q=${lat},${lng}`;
    document.getElementById('address').value = `๐ ูููุนู: ${locationLink}`;
  }

  // ุงูุถุบุท ุนูู ุงูุฎุฑูุทุฉ
  map.on('click', function(e) {
    const { lat, lng } = e.latlng;
    marker.setLatLng([lat, lng]);
    updateAddress(lat, lng);
  });

  // ุณุญุจ ุงููุงุฑูุฑ
  marker.on('dragend', function(e) {
    const { lat, lng } = e.target.getLatLng();
    updateAddress(lat, lng);
  });

  // ููุงุญุธุฉ: ูููู ููุง ุชุถูู ุฒุฑ "ุชุญุฏูุฏ ูููุนู" ูุนุชูุฏ ุนูู GPS ุฅู ุชุญุจ
</script>

  <!--   ุณูุฑุจุช ุงูููุงุณ  -->

<script>
  const carpetType = document.getElementById("carpetWeightType");
  const sizeInput = document.getElementById("size");
  const priceField = document.getElementById("estimatedPrice");

  // ูุถูู ุนูุตุฑ ุงูููุงุญุธุฉ ุจุดูู ุฏููุงูููู
  const note = document.createElement("p");
  note.style.color = "red";
  note.style.marginTop = "5px";
  note.style.fontSize = "0.9rem";
  sizeInput.parentNode.insertBefore(note, priceField.nextSibling);

  function calculatePrice() {
    const type = carpetType.value;
    const size = parseFloat(sizeInput.value);

    if (!type || isNaN(size) || size <= 0) {
      priceField.value = "";
      note.textContent = "";
      return;
    }

    let pricePerMeter = 0;

    if (type === "ุฎููู") {
      pricePerMeter = 1500;
    } else if (type === "ูุณุท" || type === "ุซููู") {
      pricePerMeter = 2000;
    }

    let estimated = size * pricePerMeter;

    if (estimated < 25000) {
      estimated = 30000;
      note.textContent = "ุงูุญุฏ ุงูุฃุฏูู ููุทูุจุงุช ูู 30,000 ุฏ.ุน";
    } else {
      note.textContent = "";
    }

    priceField.value = estimated.toLocaleString() + " ุฏ.ุน";
  }

  carpetType.addEventListener("change", calculatePrice);
  sizeInput.addEventListener("input", calculatePrice);
</script>


<script>
  document.addEventListener("DOMContentLoaded", function() {
    const toggleBtn = document.getElementById('menuToggle');
    const navList = document.getElementById('navList');

    toggleBtn.addEventListener('click', () => {
      navList.classList.toggle('show');
    });
  });
</script>




</body>
</html>

