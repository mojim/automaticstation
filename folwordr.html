<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="UTF-8" />
  <title>ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header>
  <div class="logo">
    <a href="index.html"><img  src="station2-01.svg" alt=" ุงููุญุทุฉ ุงูุงูุชููุงุชูููุฉ" /></a>
  </div>
  <div class="menu-toggle" id="menuToggle">โฐ</div>
  <nav>
    <ul id="navList">
      <li><a href="index.html">ุงูุฑุฆูุณูุฉ</a></li>
      <li><a href="service.html">ุงูุฎุฏูุงุช</a></li>
      <li><a href="order.html">ุงุญุฌุฒ ุงูุขู</a></li>
      <li><a href="folwordr.html">ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจ</a></li>
      <li><a href="#">ุงูุชููููุงุช</a></li>
      <li><a href="https://wa.me/9647832460670?text=ูุฑุญุจุงุ%20ุฃุฑุบุจ%20ุจูุนุฑูุฉ%20ุชูุงุตูู%20ุงูุฎุฏูุงุช" target="_blank" class="action-button whatsapp">ุชูุงุตู ูุนูุง</a></li>
    </ul>
  </nav>
</header>


<div class="tracking-container">
  <h2>๐ ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจ</h2>
  <input type="tel" id="phoneNumberInput" placeholder="ุฃุฏุฎู ุฑูู ุงููุงุชู" />
  <button onclick="trackOrder()">ูุชุงุจุนุฉ</button>

  <div id="trackingStatus" class="tracking-status hidden">
    <ul class="progressbar" id="progressSteps">
      <li class="step done">ุชู ุงูุงุณุชูุงู</li>
      <li class="step">ุฌุงุฑู ุงูุบุณู</li>
      <li class="step">ุงูุชุฌููู</li>
      <li class="step">ุงูุชุฌููุฒ</li>
      <li class="step">ุงูุชูุตูู</li>
    </ul>
  </div>

  <div id="deliveryFeedback" class="hidden" style="margin-top:20px;">
    <p>โ ููุฏ ุชู ุชูุตูู ุทูุจู ุจูุฌุงุญุ ุงูุฑุฌุงุก ุชูููู ุชุฌุฑุจุชู ูุนูุง (ูุชููู ุฃู ุชููู ุฑุงุถู ุนูุง):</p>

    <label>ุงูุชูููู (ุงุฎุชุฑ ูู 1 ุฅูู 5):</label><br />
    <div id="ratingButtons">
      <button type="button" onclick="setRating(1)">1</button>
      <button type="button" onclick="setRating(2)">2</button>
      <button type="button" onclick="setRating(3)">3</button>
      <button type="button" onclick="setRating(4)">4</button>
      <button type="button" onclick="setRating(5)">5</button>
    </div>

    <input type="hidden" id="rating" name="rating" />

    <label for="issue">ุฅุฐุง ูุฏูู ูุดููุฉ ูู ุทูุจูุ ูุฑุฌู ูุชุงุจุชูุง ููุง:</label><br />
    <textarea
      id="issue"
      name="issue"
      rows="4"
      cols="40"
      placeholder="ุงูุชุจ ูุดููุชู ููุง (ุงุฎุชูุงุฑู)"
    ></textarea>
    <br /><br />

    <button onclick="sendFeedback()">ุฅุฑุณุงู ุงูุชูููู ูุงููุดููุฉ</button>
  </div>
</div>

<script>
  let selectedRating = 0;

function trackOrder() {
  const phone = document.getElementById("phoneNumberInput").value.trim();
  if (!phone) {
    alert("ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุงููุงุชู ูููุชุงุจุนุฉ.");
    return;
  }

  globalPhone = phone; // ูุญูุธู ููุง

  fetch(`https://script.google.com/macros/s/AKfycbzIppstvyhiHMw6_C0APM7SS6BLQ4_DbEdc2Zj6PehXsYkZ6japKXPLJRtlxXdbBvN5dQ/exec?phone=${encodeURIComponent(phone)}`)
    .then(res => res.json())
    .then(data => {
      if (!data.status) {
        alert("๐ซ ูู ูุชู ุงูุนุซูุฑ ุนูู ุทูุจ ูุฑุชุจุท ุจูุฐุง ุงูุฑูู.");
        return;
      }

      document.getElementById("trackingStatus").classList.remove("hidden");

      const statusSteps = document.querySelectorAll(".step");
      statusSteps.forEach(step => step.classList.remove("done"));

      const statusMap = {
        "ุชู ุงูุงุณุชูุงู": 1,
        "ุฌุงุฑู ุงูุบุณู": 2,
        "ุงูุชุฌููู": 3,
        "ุงูุชุฌููุฒ": 4,
        "ุงูุชูุตูู": 5,
      };

      const currentStep = statusMap[data.status] || 0;
      for (let i = 0; i < currentStep; i++) {
        statusSteps[i].classList.add("done");
      }

      const feedbackDiv = document.getElementById("deliveryFeedback");
      if (data.status === "ุงูุชูุตูู") {
        feedbackDiv.classList.remove("hidden");
      } else {
        feedbackDiv.classList.add("hidden");
        resetRating();
      }
    })
    .catch(error => {
      console.error("โ ุฎุทุฃ:", error);
      alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุญุงูุฉ ุงูุทูุจ.");
    });
}


  function setRating(value) {
    selectedRating = value;
    document.getElementById("rating").value = value;

    const buttons = document.querySelectorAll("#ratingButtons button");
    buttons.forEach((btn, index) => {
      if (index === value - 1) {
        btn.classList.add("selected");
      } else {
        btn.classList.remove("selected");
      }
    });
  }

  function resetRating() {
    selectedRating = 0;
    document.getElementById("rating").value = "";
    const buttons = document.querySelectorAll("#ratingButtons button");
    buttons.forEach(btn => btn.classList.remove("selected"));
    document.getElementById("issue").value = "";
  }

function sendFeedback() {
  const phone = document.getElementById("phoneNumberInput").value.trim();
  const rating = selectedRating;
  const issue = document.getElementById("issue").value.trim();

  if (!phone) {
    alert("ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุงููุงุชู ุฃููุงู.");
    return;
  }
  if (!rating || rating < 1 || rating > 5) {
    alert("ูุฑุฌู ุงุฎุชูุงุฑ ุชูููู ูู 1 ุฅูู 5.");
    return;
  }

  const data = {
    phone,
    rating,
    issue
  };

  fetch("https://script.google.com/macros/s/AKfycbwLgHs_5wpVTtqBPP_0ADy7p_gx45hAwNcLQjm_Z62wWwx4zhakbYTWaEGAfqdp5t_u2Q/exec", {
  method: "POST",
  mode: "no-cors", // โ ุชุณูุญ ุจุชุฌุงูุฒ CORS ููู ุจุฏูู ุฑุฏ
  headers: {
    "Content-Type": "application/json",
  },
  body: JSON.stringify(data),
})
.then(() => {
  alert("โ ุชู ุฅุฑุณุงู ุงูุชูููู .");
  resetRating();
})
.catch(err => {
  console.error("โ ุฎุทุฃ ูู ุฅุฑุณุงู ุงูุชูููู:", err);
  alert("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุฑุณุงู. ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู.");
});

  
}

</script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const toggleBtn = document.getElementById('menuToggle');
    const navList = document.getElementById('navList');

    toggleBtn.addEventListener('click', () => {
      navList.classList.toggle('show');
    });
  });
</script>


</body>
</html>

